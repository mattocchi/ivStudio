<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:widget="http://java.sun.com/jsf/composite/widget" xmlns:p="http://primefaces.org/ui">
<head>
</head>
<body>

	<ui:composition template="/templates/primefaces/primefaces-page.xhtml">

		<ui:define name="contentP">

			<div class="container-fluid">

				<div class="row-fluid">
					<div class="span12">
						<!-- <h3>Clienti</h3> -->
						<fieldset>
							<legend>Linee</legend>
						</fieldset>
					</div>
				</div>

				<div class="row-fluid">

					<!-- <div class="span10 offset1"> -->

					<div class="span6">

						<p:pieChart id="chartContratti" value="#{beanDashboard.pieModel}" legendPosition="w" title="#{beanDashboard.contrattiNum } Contratti registrati"
							style="width:400px;height:300px" />


						<h4>Ultimi Contratti</h4>
						<h:dataTable value="#{beanDashboard.ultimiContratti }" var="item" styleClass="table">
							<h:column>
								<f:facet name="header">Cliente</f:facet>
								<h:link outcome="/clienti/scheda" value="#{beanSessione.cliente(item.clienteId).ragioneSociale }">
									<f:param name="id" value="#{item.clienteId }"></f:param>
									<span class="muted"> #{beanSessione.cliente(item.clienteId).codice }</span>
								</h:link>
							</h:column>
							<h:column>
								<f:facet name="header">Licenza Num</f:facet>
								<h:outputText value="#{item.licenzaNumero }"></h:outputText>
							</h:column>

							<h:column>
								<f:facet name="header">Canone (anno)</f:facet>
								<h:outputText value="#{item.canoneDataInizio }">
									<f:convertDateTime pattern="yyyy"></f:convertDateTime>
								</h:outputText>
							</h:column>

							<h:column>
								<f:facet name="header">Consumo (fino al)</f:facet>
								<h:outputText value="#{item.consumoDataFine }">
									<f:convertDateTime pattern="MMMM yyyy"></f:convertDateTime>
								</h:outputText>
							</h:column>

							<h:column>
								<f:facet name="header">Linee Attive</f:facet>

								<ui:repeat var="linea" value="#{beanContratti.elencoLinee(item.linee) }" varStatus="status">
									<h:outputText value="#{linea.nome } "></h:outputText>
								</ui:repeat>

							</h:column>
						</h:dataTable>

					</div>
					<div class="span6">

						<p:pieChart id="chartConsumi" value="#{beanDashboard.pieModelConsumi}" legendPosition="w" title="#{beanDashboard.consumiNum } Consumi registrati"
							style="width:400px;height:300px" />


						<h4>Ultime Ricariche</h4>
						<h:dataTable value="#{beanDashboard.ultimeRicariche }" var="item" styleClass="table">
							<h:column>
								<f:facet name="header">Cliente</f:facet>
								<h:link outcome="/clienti/scheda" value="#{beanSessione.cliente(item.clienteId).ragioneSociale }">
									<f:param name="id" value="#{item.clienteId }"></f:param>
									<span class="muted"> #{beanSessione.cliente(item.clienteId).codice }</span>
								</h:link>
							</h:column>

							<h:column>
								<f:facet name="header">Data</f:facet>
								<h:outputText value="#{item.data }">
									<f:convertDateTime pattern="dd/MM/yyyy"></f:convertDateTime>
								</h:outputText>
							</h:column>

							<h:column>
								<f:facet name="header">Valore</f:facet>
								<h:outputText value="#{item.tipo} " styleClass="label"></h:outputText>
								<h:outputText value=" #{item.valore }" styleClass="badge #{item.valore > 0 ? 'badge-success' : 'badge-important'}"></h:outputText>
							</h:column>
						</h:dataTable>
					</div>

					<!-- </div> -->


				</div>

			</div>
		</ui:define>
	</ui:composition>

</body>
</html>
